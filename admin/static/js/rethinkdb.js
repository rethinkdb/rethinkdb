(function(){
var f=void 0,g=!0,j=null,k=!1,l,aa=this;
function ba(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function m(a){return"array"==ba(a)}Math.floor(2147483648*Math.random()).toString(36);function ca(a,b,c){return a.call.apply(a.bind,arguments)}function da(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ea(a,b,c){ea=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ca:da;return ea.apply(j,arguments)}function n(a,b){var c=a.split("."),d=aa;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&b!==f?d[e]=b:d=d[e]?d[e]:d[e]={}}function o(a,b){function c(){}c.prototype=b.prototype;a.Uc=b.prototype;a.prototype=new c;a.prototype.constructor=a};aa.rethinkdb=function(a){return fa(a)};function q(a){return a instanceof r?a:ga(a)}function s(a){return a instanceof ha?a:ja(a)}function t(a,b){if(a){var c=b;m(b)||(c=[c]);if(!c.some(function(b){return"string"===typeof b?typeof a===b:a instanceof b})){if(m(b))throw new TypeError("Function argument "+a+" must be one of the types "+b);throw new TypeError("Function argument "+a+" must be of the type "+b);}}}
function v(a,b){if(a.length<b)throw new TypeError("Function requires at least "+b+" argument"+(1<b?"s.":"."));}function w(a){function b(a){return y.prototype.Z.call(b,a)}var c=arguments[0],d=Array.prototype.slice.call(arguments,1);b.__proto__=c.prototype;c.apply(b,d);return b};function ga(a){if(!(a instanceof y))if("number"==typeof a)a=w(ka,a);else if("boolean"==typeof a)a=w(la,a);else if("string"==typeof a)a=w(ma,a);else if(m(a))a=w(na,a);else var b=typeof a,a="object"==b&&a!=j||"function"==b?w(oa,a):w(pa,a);return a}n("rethinkdb.expr",ga);n("rethinkdb.js",function(a){v(arguments,1);t(a,"string");return w(qa,a)});n("rethinkdb.table",function(a){v(arguments,1);t(a,"string");return w(z,a)});function r(){}r.prototype.S=function(a,b){b=b||ra;b.S(this,a)};r.prototype.run=r.prototype.S;
r.prototype.ea=function(){ra.ea(this)};r.prototype.runp=r.prototype.ea;r.prototype.ba=function(a,b){ra.ba(this,a,b)};r.prototype.iter=r.prototype.ba;r.prototype.d=function(){return"----"};function sa(){}o(sa,r);sa.prototype.k=function(){var a=new ta,b=this.compile();a.fa(b);b=new A;b.b(ua);B(b,3,a);return b};function va(a){Error.captureStackTrace?Error.captureStackTrace(this,va):this.stack=Error().stack||"";a&&(this.message=String(a))}o(va,Error);va.prototype.name="CustomError";function wa(a,b,c){this.Sc=a;this.o=b;this.F=c.name;this.P=!!c.z;this.Rc=!!c.required;this.l=c.a;this.Aa=c.type;this.Na=k;switch(this.l){case xa:case ya:case za:case Aa:case Ba:this.Na=g}this.ja=c.defaultValue}var xa=3,ya=4,za=6,Aa=16,Ba=18;var Ca=Array.prototype;function Da(a,b){return a>b?1:a<b?-1:0};function Ea(a,b,c){this.Va=a;this.F=b.name||j;this.Qc=b.e||j;this.Oc=b.h;this.C={};for(a=0;a<c.length;a++)b=c[a],this.C[b.o]=b}function Fa(a){var a=a.C,b=[],c=0,d;for(d in a)b[c++]=a[d];Ca.sort.call(b,function(a,b){return a.o-b.o}||Da);return b};function C(){this.v={};this.K=this.constructor.K;this.C=this.K.C;this.G=this.za=j}l=C.prototype;l.$=function(){return this.K};l.get=function(a,b){return D(this,a.o,b)};l.set=function(a,b){B(this,a.o,b)};l.add=function(a,b){E(this,a.o,b)};
l.j=function(a){if(!a||this.constructor!=a.constructor)return k;for(var b=Fa(this.$()),c=0;c<b.length;c++){var d=b[c];if(F(this,d.o)!=F(a,d.o))return k;if(F(this,d.o)){var e=11==d.l||10==d.l,i=Ga(this,d),h=Ga(a,d);if(d.P){if(i.length!=h.length)return k;for(d=0;d<i.length;d++)if(!(e?i[d].j(h[d]):i[d]==h[d]))return k}else if(!(e?i.j(h):i==h))return k}}return g};function F(a,b){return b in a.v&&a.v[b]!==f&&a.v[b]!==j}
function Ga(a,b){var c=b.o;if(!c in a.v)return j;var d=a.v[c];return d==j?j:a.za?!(c in a.G)?(d=a.za.Pc(a,b,d),a.G[c]=d):a.G[c]:d}function D(a,b,c){b=a.C[b];a=Ga(a,b);if(b.P)return m(a),a[c||0];m(a);return a}function G(a,b){var c;if(F(a,b))c=D(a,b,f);else{c=a.C[b];if(c.ja===f){var d=c.Aa;c.ja=d===Boolean?k:d===Number?0:d===String?"":new d}c=c.ja}return c}function Ha(a,b){var c=Ga(a,a.C[b]);c==j||m(c);return c||[]}
function Ia(a,b){return a.C[b].P?(F(a,b)&&m(a.v[b]),F(a,b)?a.v[b].length:0):F(a,b)?1:0}function B(a,b,c){a.v[b]=c;a.G&&(a.G[b]=c)}function E(a,b,c){a.v[b]||(a.v[b]=[]);a.v[b].push(c);a.G&&delete a.G[b]}function H(a,b){var c=[],d,e;for(e in b)b.hasOwnProperty(e)&&(0==e?d=b[0]:c.push(new wa(a,e,b[e])));a.K=new Ea(a,d,c);a.$=function(){return a.K}};function I(){C.apply(this)}o(I,C);I.prototype.U=function(a){B(this,1,a)};function Ja(){C.apply(this)}o(Ja,C);Ja.prototype.I=function(a){B(this,1,a)};Ja.prototype.fa=function(a){B(this,2,a)};function J(){C.apply(this)}o(J,C);J.prototype.b=function(a){B(this,1,a)};J.prototype.I=function(a){B(this,2,a)};function Ka(a){return G(a,15)}function La(){C.apply(this)}o(La,C);function Ma(){C.apply(this)}o(Ma,C);function Na(){C.apply(this)}o(Na,C);function Oa(){C.apply(this)}o(Oa,C);
Oa.prototype.s=function(){return G(this,1)};Oa.prototype.n=function(a){B(this,1,a)};Oa.prototype.D=function(a){B(this,2,a)};Oa.prototype.H=function(a){B(this,3,a)};function Pa(){C.apply(this)}o(Pa,C);Pa.prototype.s=function(){return G(this,1)};Pa.prototype.n=function(a){B(this,1,a)};function K(){C.apply(this)}o(K,C);K.prototype.b=function(a){B(this,1,a)};K.prototype.Z=function(){return D(this,2)};K.prototype.T=function(a){B(this,2,a)};K.prototype.ka=function(){return F(this,2)};
var Qa=19,Ra={mc:1,Mb:2,Sb:3,Qb:4,Tb:5,rc:6,Ub:7,gc:8,sb:9,zc:11,ob:14,Dc:15,jc:16,Eb:17,ic:18,xb:Qa,Jb:20,fc:21,yb:22,qc:23,Db:24,ac:26,Jc:27,nc:28,Bc:29,tb:30,xc:31,Ob:32,qb:35,pb:36,vc:37,Wb:38,Mc:39};function Sa(){C.apply(this)}o(Sa,C);function Ta(){C.apply(this)}o(Ta,C);Ta.prototype.u=function(a){B(this,1,a)};function Ua(){C.apply(this)}o(Ua,C);Ua.prototype.u=function(a){B(this,1,a)};function Va(){C.apply(this)}o(Va,C);Va.prototype.Z=function(){return D(this,1)};
Va.prototype.T=function(a){B(this,1,a)};Va.prototype.ka=function(){return F(this,1)};function Wa(){C.apply(this)}o(Wa,C);function Xa(){C.apply(this)}o(Xa,C);Xa.prototype.D=function(a){B(this,1,a)};function Ya(){C.apply(this)}o(Ya,C);Ya.prototype.m=function(a){B(this,4,a)};function L(){C.apply(this)}o(L,C);L.prototype.A=function(a){B(this,1,a)};L.prototype.m=function(a){B(this,2,a)};function Za(){C.apply(this)}o(Za,C);Za.prototype.A=function(a){B(this,1,a)};Za.prototype.m=function(a){B(this,2,a)};
function ta(){C.apply(this)}o(ta,C);ta.prototype.fa=function(a){B(this,1,a)};function M(){C.apply(this)}o(M,C);M.prototype.b=function(a){B(this,1,a)};function $a(){C.apply(this)}o($a,C);$a.prototype.V=function(a){B(this,1,a)};$a.prototype.u=function(a){B(this,2,a)};function ab(){C.apply(this)}o(ab,C);ab.prototype.V=function(a){B(this,1,a)};function bb(){C.apply(this)}o(bb,C);bb.prototype.V=function(a){B(this,1,a)};bb.prototype.u=function(a){B(this,2,a)};function cb(){C.apply(this)}o(cb,C);
cb.prototype.s=function(){return G(this,1)};cb.prototype.n=function(a){B(this,1,a)};function db(){C.apply(this)}o(db,C);db.prototype.I=function(a){B(this,2,a)};function eb(){C.apply(this)}o(eb,C);l=eb.prototype;l.s=function(){return G(this,1)};l.n=function(a){B(this,1,a)};l.D=function(a){B(this,2,a)};l.H=function(a){B(this,3,a)};l.u=function(a){B(this,4,a)};function fb(){C.apply(this)}o(fb,C);fb.prototype.s=function(){return G(this,1)};fb.prototype.n=function(a){B(this,1,a)};
fb.prototype.D=function(a){B(this,2,a)};fb.prototype.H=function(a){B(this,3,a)};function gb(){C.apply(this)}o(gb,C);l=gb.prototype;l.s=function(){return G(this,1)};l.n=function(a){B(this,1,a)};l.D=function(a){B(this,2,a)};l.H=function(a){B(this,3,a)};l.u=function(a){B(this,4,a)};function N(){C.apply(this)}o(N,C);N.prototype.b=function(a){B(this,1,a)};N.prototype.U=function(a){B(this,2,a)};function hb(){C.apply(this)}o(hb,C);hb.prototype.s=function(){return G(this,3)};
hb.prototype.n=function(a){B(this,3,a)};function A(){C.apply(this)}o(A,C);A.prototype.b=function(a){B(this,1,a)};A.prototype.L=function(){return D(this,2)};A.prototype.ya=function(){return G(this,2)};A.prototype.na=function(a){B(this,2,a)};var ua=1,ib={wc:ua,Nc:2,zb:3,Ac:4,hc:5};function jb(){C.apply(this)}o(jb,C);jb.prototype.L=function(){return D(this,2)};jb.prototype.ya=function(){return G(this,2)};jb.prototype.na=function(a){B(this,2,a)};function kb(){C.apply(this)}o(kb,C);
H(I,{"0":{name:"TableRef",e:"TableRef"},1:{name:"db_name",a:9,type:String},2:{name:"table_name",a:9,type:String}});H(Ja,{"0":{name:"VarTermTuple",e:"VarTermTuple"},1:{name:"var",a:9,type:String},2:{name:"term",a:11,type:J}});
H(J,{"0":{name:"Term",e:"Term"},1:{name:"type",a:14,defaultValue:0,type:{Zb:0,Lc:1,bc:2,wb:3,Rb:4,Ib:5,oc:6,Cc:7,JSON:8,BOOL:9,rb:10,pc:11,Nb:12,Ic:13,Yb:14,Vb:15}},2:{name:"var",a:9,type:String},3:{name:"let",a:11,type:La},4:{name:"call",a:11,type:Ma},5:{name:"if_",a:11,type:Na},6:{name:"error",a:9,type:String},7:{name:"number",a:1,type:Number},8:{name:"valuestring",a:9,type:String},9:{name:"jsonstring",a:9,type:String},10:{name:"valuebool",a:8,type:Boolean},11:{name:"array",z:g,a:11,type:J},12:{name:"object",
z:g,a:11,type:Ja},14:{name:"get_by_key",a:11,type:Oa},15:{name:"table",a:11,type:Pa},16:{name:"javascript",a:9,type:String}});H(La,{"0":{name:"Let",h:J,e:"Term.Let"},1:{name:"binds",z:g,a:11,type:Ja},2:{name:"expr",a:11,type:J}});H(Ma,{"0":{name:"Call",h:J,e:"Term.Call"},1:{name:"builtin",a:11,type:K},2:{name:"args",z:g,a:11,type:J}});H(Na,{"0":{name:"If",h:J,e:"Term.If"},1:{name:"test",a:11,type:J},2:{name:"true_branch",a:11,type:J},3:{name:"false_branch",a:11,type:J}});
H(Oa,{"0":{name:"GetByKey",h:J,e:"Term.GetByKey"},1:{name:"table_ref",a:11,type:I},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:J}});H(Pa,{"0":{name:"Table",h:J,e:"Term.Table"},1:{name:"table_ref",a:11,type:I}});
H(K,{"0":{name:"Builtin",e:"Builtin"},1:{name:"type",a:14,defaultValue:1,type:Ra},2:{name:"attr",a:9,type:String},3:{name:"attrs",z:g,a:9,type:String},4:{name:"comparison",a:14,defaultValue:1,type:{Hb:1,lc:2,ec:3,$b:4,Pb:5,Lb:6}},5:{name:"filter",a:11,type:Sa},6:{name:"map",a:11,type:Ta},7:{name:"concat_map",a:11,type:Ua},8:{name:"order_by",z:g,a:11,type:Va},9:{name:"reduce",a:11,type:Ya},10:{name:"grouped_map_reduce",a:11,type:Wa},11:{name:"range",a:11,type:Xa}});
H(Sa,{"0":{name:"Filter",h:K,e:"Builtin.Filter"},1:{name:"predicate",a:11,type:Za}});H(Ta,{"0":{name:"Map",h:K,e:"Builtin.Map"},1:{name:"mapping",a:11,type:L}});H(Ua,{"0":{name:"ConcatMap",h:K,e:"Builtin.ConcatMap"},1:{name:"mapping",a:11,type:L}});H(Va,{"0":{name:"OrderBy",h:K,e:"Builtin.OrderBy"},1:{name:"attr",a:9,type:String},2:{name:"ascending",a:8,defaultValue:1,type:Boolean}});
H(Wa,{"0":{name:"GroupedMapReduce",h:K,e:"Builtin.GroupedMapReduce"},1:{name:"group_mapping",a:11,type:L},2:{name:"value_mapping",a:11,type:L},3:{name:"reduction",a:11,type:Ya}});H(Xa,{"0":{name:"Range",h:K,e:"Builtin.Range"},1:{name:"attrname",a:9,type:String},2:{name:"lowerbound",a:11,type:J},3:{name:"upperbound",a:11,type:J}});H(Ya,{"0":{name:"Reduction",e:"Reduction"},1:{name:"base",a:11,type:J},2:{name:"var1",a:9,type:String},3:{name:"var2",a:9,type:String},4:{name:"body",a:11,type:J}});
H(L,{"0":{name:"Mapping",e:"Mapping"},1:{name:"arg",a:9,type:String},2:{name:"body",a:11,type:J}});H(Za,{"0":{name:"Predicate",e:"Predicate"},1:{name:"arg",a:9,type:String},2:{name:"body",a:11,type:J}});H(ta,{"0":{name:"ReadQuery",e:"ReadQuery"},1:{name:"term",a:11,type:J},2:{name:"max_chunk_size",a:3,type:String},3:{name:"max_age",a:3,type:String}});
H(M,{"0":{name:"WriteQuery",e:"WriteQuery"},1:{name:"type",a:14,defaultValue:1,type:{Kc:1,Cb:2,kc:3,Xb:4,Kb:6,uc:7,sc:8,tc:9}},2:{name:"update",a:11,type:$a},3:{name:"delete",a:11,type:ab},4:{name:"mutate",a:11,type:bb},5:{name:"insert",a:11,type:cb},7:{name:"for_each",a:11,type:db},8:{name:"point_update",a:11,type:eb},9:{name:"point_delete",a:11,type:fb},10:{name:"point_mutate",a:11,type:gb}});
H($a,{"0":{name:"Update",h:M,e:"WriteQuery.Update"},1:{name:"view",a:11,type:J},2:{name:"mapping",a:11,type:L}});H(ab,{"0":{name:"Delete",h:M,e:"WriteQuery.Delete"},1:{name:"view",a:11,type:J}});H(bb,{"0":{name:"Mutate",h:M,e:"WriteQuery.Mutate"},1:{name:"view",a:11,type:J},2:{name:"mapping",a:11,type:L}});H(cb,{"0":{name:"Insert",h:M,e:"WriteQuery.Insert"},1:{name:"table_ref",a:11,type:I},2:{name:"terms",z:g,a:11,type:J},3:{name:"overwrite",a:8,defaultValue:0,type:Boolean}});
H(db,{"0":{name:"ForEach",h:M,e:"WriteQuery.ForEach"},1:{name:"stream",a:11,type:J},2:{name:"var",a:9,type:String},3:{name:"queries",z:g,a:11,type:M}});H(eb,{"0":{name:"PointUpdate",h:M,e:"WriteQuery.PointUpdate"},1:{name:"table_ref",a:11,type:I},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:J},4:{name:"mapping",a:11,type:L}});H(fb,{"0":{name:"PointDelete",h:M,e:"WriteQuery.PointDelete"},1:{name:"table_ref",a:11,type:I},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:J}});
H(gb,{"0":{name:"PointMutate",h:M,e:"WriteQuery.PointMutate"},1:{name:"table_ref",a:11,type:I},2:{name:"attrname",a:9,type:String},3:{name:"key",a:11,type:J},4:{name:"mapping",a:11,type:L}});H(N,{"0":{name:"MetaQuery",e:"MetaQuery"},1:{name:"type",a:14,defaultValue:1,type:{Ab:1,Fb:2,cc:3,Bb:4,Gb:5,dc:6}},2:{name:"db_name",a:9,type:String},3:{name:"create_table",a:11,type:hb},4:{name:"drop_table",a:11,type:I}});
H(hb,{"0":{name:"CreateTable",h:N,e:"MetaQuery.CreateTable"},1:{name:"datacenter",a:9,type:String},3:{name:"table_ref",a:11,type:I},4:{name:"primary_key",a:9,defaultValue:"id",type:String},5:{name:"cache_size",a:3,defaultValue:"1073741824",type:String}});H(A,{"0":{name:"Query",e:"Query"},1:{name:"type",a:14,defaultValue:ua,type:ib},2:{name:"token",a:3,type:String},3:{name:"read_query",a:11,type:ta},4:{name:"write_query",a:11,type:M},5:{name:"meta_query",a:11,type:N}});
H(jb,{"0":{name:"Response",e:"Response"},1:{name:"status_code",a:14,defaultValue:0,type:{Ec:0,Fc:1,Gc:2,Hc:3,vb:101,ub:102,yc:103}},2:{name:"token",a:3,type:String},3:{name:"response",z:g,a:9,type:String},4:{name:"error_message",a:9,type:String},5:{name:"backtrace",a:11,type:kb}});H(kb,{"0":{name:"Backtrace",h:jb,e:"Response.Backtrace"},1:{name:"frame",z:g,a:9,type:String}});function y(){}o(y,sa);function lb(a){this.Wa=a||""}o(lb,y);lb.prototype.compile=function(){var a=new J;a.b(5);B(a,6,this.Wa);return a};lb.prototype.d=function(a){return a?"^^^^^^^^^":"r.error()"};n("rethinkdb.error",function(){return new lb});function pa(a){this.g=a}o(pa,y);pa.prototype.compile=function(){var a=new J;a.b(8);var b=JSON.stringify(this.g);B(a,9,b);return a};function ka(a){this.g="undefined"===typeof a?j:a}o(ka,y);
ka.prototype.compile=function(){var a=new J;this.g===j?a.b(0):(a.b(6),B(a,7,this.g));return a};ka.prototype.d=function(a){var b="r.expr("+this.g+")";return a?b.replace(/./g,"^"):b};function la(a){this.g=a}o(la,y);la.prototype.compile=function(){var a=new J;a.b(9);B(a,10,this.g);return a};function ma(a){this.g=a}o(ma,y);ma.prototype.compile=function(){var a=new J;a.b(7);B(a,8,this.g);return a};ma.prototype.d=function(a){var b="r.expr('"+this.g+"')";return a?b.replace(/./g,"^"):b};
function na(a){this.g=[];for(var b=0;b<a.length;b++){var c=q(a[b]);this.g.push(c)}}o(na,y);na.prototype.compile=function(){var a=new J;a.b(10);for(var b=0;b<this.g.length;b++){var c=this.g[b].compile();E(a,11,c)}return a};
na.prototype.d=function(a){var b=this.g.map(function(a){return a.d()});if(a){console.log(a);console.log(a[0]);console.log(a[0].split(":"));var c=a[0].split(":");a.shift();c=parseInt(c[1],10);b=b.map(O);b[c]=this.g[c].d(a);return"        "+b.join("  ")+"  "}return"r.expr(["+b.join(", ")+"])"};function oa(a){this.g={};for(var b in a)if(a.hasOwnProperty(b)){var c=q(a[b]);this.g[b]=c}}o(oa,y);
oa.prototype.compile=function(){var a=new J;a.b(11);for(var b in this.g)if(this.g.hasOwnProperty(b)){var c=new Ja;c.I(b);c.fa(this.g[b].compile());E(a,12,c)}return a};
oa.prototype.d=function(a){if(a){var b=a[0].split(":");a.shift();b=b[1];c=[];for(d in this.g)this.g.hasOwnProperty(d)&&(d===b?c.push(O("'"+d+"':")+this.g[d].d(a)):c.push(O("'"+d+"':"+this.g[d].d())));return"        "+c.join("  ")+"  "}var c=[],d;for(d in this.g)this.g.hasOwnProperty(d)&&c.push("'"+d+"':"+this.g[d].d());return"r.expr({"+c.join(", ")+"})"};function qa(a){this.gb=a}o(qa,y);qa.prototype.compile=function(){var a=new J;a.b(14);B(a,16,this.gb);return a};
function ha(a,b){1>a.length&&a.push("");this.i=a;this.body=b}ha.prototype.d=function(a){return a?O("function("+this.i.join(", ")+") {return ")+this.body.d(a)+" ":"function("+this.i.join(", ")+") {return "+this.body.d()+"}"};
function ja(a){var b,c;if("function"===typeof a&&!(a instanceof r)){b=[];for(c=0;c<a.length;c++)b.push("genSym"+b.length);c=a.apply(j,b.map(function(a){return mb(a)}));if(c===f)throw new P("ReQL function must return ReQL expression");}else c=arguments[arguments.length-1],b=Array.prototype.slice.call(arguments,0,arguments.length-1);c=q(c);b.forEach(function(a){return t(a,"string")});return w(ha,b,c)}function Q(a,b,c,d){this.Ka=a;this.sa=b;this.qa=d||j;this.d=c}o(Q,y);
Q.prototype.compile=function(){var a=new K;a.b(this.Ka);this.qa&&this.qa(a);var b=new Ma;B(b,1,a);for(var c in this.sa)a=this.sa[c].compile(),E(b,2,a);c=new J;c.b(3);B(c,4,b);return c};function nb(a,b){y.prototype[b]=function(c){v(arguments,1);c=q(c);return w(Q,a,[this,c],ob(b,this,c))}}function pb(a,b){y.prototype[b]=function(c){v(arguments,1);c=q(c);return w(Q,Qa,[this,c],ob(b,this,c),function(b){B(b,4,a)})}}nb(14,"add");nb(15,"sub");nb(16,"mul");nb(17,"div");nb(18,"mod");pb(1,"eq");pb(2,"ne");
pb(3,"lt");pb(4,"le");pb(5,"gt");pb(6,"ge");y.prototype.la=function(){return w(Q,1,[this],ob("not",this))};y.prototype.not=y.prototype.la;y.prototype.count=function(){return w(Q,26,[this],ob("count",this))};y.prototype.count=y.prototype.count;y.prototype.ra=function(a){v(arguments,1);a=q(a);return w(Q,36,[this,a],ob("and",this,a))};y.prototype.and=y.prototype.ra;y.prototype.Ba=function(a){v(arguments,1);a=q(a);return w(Q,35,[this,a],ob("or",this,a))};y.prototype.or=y.prototype.Ba;
y.prototype.Ia=function(a,b,c){v(arguments,2);a=q(a);b=q(b);t(c,"string");var d=c?c:"id";return w(Q,37,[this],ob("between",this,a,b,d),function(c){var i=new Xa;i.D(d);var h=a.compile();B(i,2,h);h=b.compile();B(i,3,h);B(c,11,i)})};y.prototype.between=y.prototype.Ia;y.prototype.append=function(a){v(arguments,1);a=q(a);return w(Q,9,[this,a],ob("append",this,a))};y.prototype.append=y.prototype.append;function qb(a,b,c){Q.call(this,11,[a,w(ka,b),w(ka,c)],R)}o(qb,Q);
y.prototype.slice=function(a,b){v(arguments,1);return w(qb,this,a,b)};y.prototype.slice=y.prototype.slice;y.prototype.Ua=function(a){v(arguments,1);t(a,"number");return w(qb,this,0,a)};y.prototype.limit=y.prototype.Ua;y.prototype.fb=function(a){v(arguments,1);t(a,"number");return w(qb,this,a)};y.prototype.skip=y.prototype.fb;y.prototype.Za=function(a){v(arguments,1);a=q(a);return w(Q,28,[this,a],ob("nth",this,a))};y.prototype.nth=y.prototype.Za;
y.prototype.filter=function(a){var b;if("object"===typeof a&&!(a instanceof r)){var c=[],d;for(d in a)a.hasOwnProperty(d)&&c.push(fa(d).eq(ga(a[d])));b=w(ha,[""],w(Q,36,c,R))}else b=s(a);return w(Q,20,[this],R,function(a){var c=new Za;c.A(b.i[0]);c.m(b.body.compile());var d=new Sa;B(d,1,c);B(a,5,d)})};y.prototype.filter=y.prototype.filter;y.prototype.map=function(a){a=s(a);return w(Q,21,[this],R,function(b){var c=new L;c.A(a.i[0]);c.m(a.body.compile());var d=new Ta;d.u(c);B(b,6,d)})};
y.prototype.map=y.prototype.map;y.prototype.$a=function(a){v(arguments,1);var b=Array.prototype.slice.call(arguments,0);b.forEach(function(a){t(a,"string")});return w(Q,23,[this],R,function(a){for(var d=0;d<b.length;d++){var e=g,i=b[d];"-"===i[0]&&(e=k,i=i.slice(1));var h=new Va;h.T(i);B(h,2,e);E(a,8,h)}})};y.prototype.orderby=y.prototype.$a;y.prototype.Oa=function(a){t(a,"string");a=a?this.map(fa(a)):this;return w(Q,24,[a],R)};y.prototype.distinct=y.prototype.Oa;
y.prototype.reduce=function(a,b){v(arguments,2);var a=q(a),b=s(b),c=this;return w(Q,31,[this],function(d){if(d)if("reduce"===d[0]){d.shift();if("body"===d[0])return d.shift(),O(c.d()+".reduce("+a.d()+", ")+b.d(d)+" ";if("base"===d[0])return d.shift(),O(c.d()+".reduce(")+a.d(d)+O(", "+b.d()+")")}else return d.shift(),c.d(d)+O(".reduce("+a.d()+", "+b.d()+")");else return c.d()+".reduce("+a.d()+", "+b.d()+")"},function(c){var e=new Ya,i=a.compile();B(e,1,i);B(e,2,b.i[0]);B(e,3,b.i[1]);e.m(b.body.compile());
B(c,9,e)})};y.prototype.reduce=y.prototype.reduce;y.prototype.Ra=function(a,b,c,d){v(arguments,4);a=s(a);b=s(b);c=q(c);d=s(d);return w(Q,32,[this],R,function(e){var i=new L;i.A(a.i[0]);i.m(a.body.compile());var h=new L;h.A(b.i[0]);h.m(b.body.compile());var p=new Ya,u=c.compile();B(p,1,u);B(p,2,d.i[0]);B(p,3,d.i[1]);p.m(d.body.compile());u=new Wa;B(u,1,i);B(u,2,h);B(u,3,p);B(e,10,u)})};y.prototype.groupedMapReduce=y.prototype.Ra;y.prototype.ka=function(a){t(a,"string");return w(Q,4,[this],R,function(b){b.T(a)})};
y.prototype.hasAttr=y.prototype.ka;y.prototype.Z=function(a){t(a,"string");var b=this;return w(Q,2,[this],function(c){return c?"arg:0"===c[0]?(c.shift(),b.d(c)):O(b.d())+("('"+a+"')").replace(/./g,"^"):b.d()+"('"+a+"')"},function(b){b.T(a)})};y.prototype.getAttr=y.prototype.Z;y.prototype.Ca=function(){var a=Array.prototype.slice.call(arguments,0);m(a)||(a=[a]);a.forEach(function(a){t(a,"string")});return w(Q,6,[this],R,function(b){for(var c in a)E(b,3,a[c])})};y.prototype.pickAttrs=y.prototype.Ca;
y.prototype.nb=function(a){m(a)||(a=[a]);a.forEach(function(a){t(a,"string")});return w(Q,39,[this],R,function(b){for(var c in a)E(b,3,a[c])})};y.prototype.without=y.prototype.nb;y.prototype.ab=function(){var a=Array.prototype.slice.call(arguments,0);return this.map(function(b){return y.prototype.Ca.apply(b,a)})};y.prototype.pluck=y.prototype.ab;function rb(a){this.ga=a}o(rb,y);rb.prototype.compile=function(){var a=new J;a.b(1);a.I(this.ga);return a};
rb.prototype.d=function(a){var b="r.R('$"+this.ga+"')";return a?b.replace(/./g,"^"):b};function sb(a){this.ga=a}o(sb,y);sb.prototype.compile=function(){var a=new J;a.b(15);a.I(this.ga);return a};function tb(a,b){Q.call(this,2,[a],R,function(a){a.T(b)})}o(tb,Q);function fa(a){t(a,"string");var a=a.split("."),b=a.shift();"@"===b[0]&&1<b.length?a.unshift(b.slice(1)):"@"!==b[0]&&a.unshift(b);for(var c=w(sb);b=a.shift();)c=w(tb,c,b);return c}n("rethinkdb.R",fa);
function mb(a){t(a,"string");for(var a=a.split("."),b=a.shift(),c=w(rb,b);b=a.shift();)c=w(tb,c,b);return c}n("rethinkdb.letVar",mb);y.prototype.extend=function(a){a=q(a);return w(Q,8,[this,a],R)};y.prototype.extend=y.prototype.extend;y.prototype.La=function(a){a=s(a);return w(Q,22,[this],R,function(b){var c=new L;c.A(a.i[0]);c.m(a.body.compile());var d=new Ua;d.u(c);B(b,7,d)})};y.prototype.concatMap=y.prototype.La;function ub(a,b,c){this.kb=a;this.lb=b;this.Qa=c}o(ub,y);
ub.prototype.compile=function(){var a=new Na,b=this.kb.compile();B(a,1,b);b=this.lb.compile();B(a,2,b);b=this.Qa.compile();B(a,3,b);b=new J;b.b(4);B(b,5,a);return b};n("rethinkdb.ifThenElse",function(a,b,c){t(b,r);t(c,r);a=q(a);return w(ub,a,b,c)});function vb(a,b){this.ha=a;this.Ja=b}o(vb,y);
vb.prototype.compile=function(){var a=new La,b;for(b in this.ha)if(this.ha.hasOwnProperty(b)){var c=this.ha[b],d=new Ja;d.I(b);d.fa(c.compile());E(a,1,d)}b=this.Ja.compile();B(a,2,b);b=new J;b.b(2);B(b,3,a);return b};n("rethinkdb.let",function(a,b){t(b,r);for(var c in a)a.hasOwnProperty(c)&&t(a[c],y);return w(vb,a,b)});function wb(a,b){this.Ta=a;this.wa=b}o(wb,r);
wb.prototype.k=function(){var a=new db,b=this.Ta.compile();B(a,1,b);a.I(this.wa.i[0]);b=this.wa.body.k();b=D(b,4);if(!b)throw new P("For each requires a write query to execute");E(a,3,b);b=new M;b.b(6);B(b,7,a);a=new A;a.b(2);B(a,4,b);return a};y.prototype.forEach=function(a){a=s(a);return w(wb,this,a)};y.prototype.forEach=y.prototype.forEach;y.prototype.hb=function(){return w(Q,29,[this],R)};y.prototype.streamToArray=y.prototype.hb;y.prototype.Ha=function(){return w(Q,30,[this],R)};
y.prototype.arrayToStream=y.prototype.Ha;function z(a,b){this.O=b||j;this.F=a}o(z,y);z.prototype.compile=function(){var a=new J;a.b(13);var b=new Pa,c=new I;c.U(this.O||ra.O);B(c,2,this.F);b.n(c);B(a,15,b);return a};function xb(a,b){this.q=a;this.w=b}o(xb,y);xb.prototype.compile=function(){var a=this.q.compile(),b=D(a,15).s(),a=new Oa;a.n(b);a.D("id");a.H(this.w.compile());b=new J;b.b(12);B(b,14,a);return b};z.prototype.get=function(a){v(arguments,1);a=q(a);return w(xb,this,a)};z.prototype.get=z.prototype.get;
function yb(a,b){this.q=a;this.va=b}o(yb,r);yb.prototype.k=function(){var a=this.q.compile(),b=D(a,15).s(),a=new cb;a.n(b);for(b=0;b<this.va.length;b++){var c=this.va[b].compile();E(a,2,c)}b=new M;b.b(4);B(b,5,a);a=new A;a.b(2);B(a,4,b);return a};z.prototype.Sa=function(a){v(arguments,1);m(a)||(a=[a]);a=a.map(ga);return new yb(this,a)};z.prototype.insert=z.prototype.Sa;function zb(a){this.W=a}o(zb,r);
zb.prototype.k=function(){var a=new ab;a.V(this.W.compile());var b=new M;b.b(2);B(b,3,a);a=new A;a.b(2);B(a,4,b);return a};function Ab(a,b){this.q=a;this.w=b}o(Ab,r);Ab.prototype.k=function(){var a=new fb;a.n(Ka(this.q.compile()).s());a.D("id");a.H(this.w.compile());var b=new M;b.b(8);B(b,9,a);a=new A;a.b(2);B(a,4,b);return a};y.prototype.Ma=function(){return this instanceof xb?new Ab(this.q,this.w):new zb(this)};y.prototype.del=y.prototype.Ma;function Bb(a,b){this.W=a;this.t=b}o(Bb,r);
Bb.prototype.k=function(){var a=new L;a.A(this.t.i[0]);a.m(this.t.body.compile());var b=new $a;b.V(this.W.compile());b.u(a);a=new M;a.b(1);B(a,2,b);b=new A;b.b(2);B(b,4,a);return b};function Cb(a,b,c){this.q=a;this.w=b;this.t=c}o(Cb,r);Cb.prototype.k=function(){var a=new L;a.A(this.t.i[0]);a.m(this.t.body.compile());var b=new eb;b.n(Ka(this.q.compile()).s());b.D("id");b.H(this.w.compile());b.u(a);a=new M;a.b(7);B(a,8,b);b=new A;b.b(2);B(b,4,a);return b};
y.prototype.update=function(a){v(arguments,1);a=s(a);return this instanceof xb?new Cb(this.q,this.w,a):new Bb(this,a)};y.prototype.update=y.prototype.update;function Db(a,b){this.W=a;this.t=b}o(Db,r);Db.prototype.k=function(){var a=new L;a.A(this.t.i[0]);a.m(this.t.body.compile());var b=new bb;b.V(this.W.compile());b.u(a);a=new M;a.b(3);B(a,4,b);b=new A;b.b(2);B(b,4,a);return b};function Eb(a,b,c){this.q=a;this.w=b;this.t=c}o(Eb,r);
Eb.prototype.k=function(){var a=new L;a.A(this.t.i[0]);a.m(this.t.body.compile());var b=new gb;b.n(Ka(this.q.compile()).s());b.D("id");b.H(this.w.compile());b.u(a);a=new M;a.b(9);B(a,10,b);b=new A;b.b(2);B(b,4,a);return b};y.prototype.Xa=function(a){v(arguments,1);a=s(a);return this instanceof xb?new Eb(this.q,this.w,a):new Db(this,a)};y.prototype.mutate=y.prototype.Xa;function Fb(a){this.name="Runtime Error";this.message=a||"The RDB runtime experienced an error"}o(Fb,Error);function Gb(a){this.name="Broken Client";this.message=a||"The client sent the server an incorrectly formatted message"}o(Gb,Error);function Hb(a){this.name="Bad Query";this.message=a||"This query contains type errors"}o(Hb,Error);function P(a){this.name="RDB Client Error";this.message=a||"The RDB client has experienced an error"}o(P,Error);
function ob(a,b,c){var d=Array.prototype.slice.call(arguments,2);return function(c){var i=d.map(function(a){return a instanceof r?a.d():a.toString()});if(c){var h=c[0].split(":");if("arg"===h[0]){h[1]=parseInt(h[1],10);var i=i.map(O),p;0===h[1]?p=b.d(c.shift()):(p=O(b.d()),h=h[1]-1,c=d[h].d(c.shift()),i[h]=c);i=i.join("  ");return p+" "+O(a)+" "+i+" "}}else return b.d()+"."+a+"("+i.join(", ")+")"}}function R(){return" todo "}function O(a){return a.replace(/./g," ")};function Ib(){}Ib.prototype.xa=function(a,b){return 11==a.l||10==a.l?Jb(this,b):b};function Lb(a,b){this.f=a|0;this.c=b|0}var Mb={};function Nb(a){if(-128<=a&&128>a){var b=Mb[a];if(b)return b}b=new Lb(a|0,0>a?-1:0);-128<=a&&128>a&&(Mb[a]=b);return b}function S(a){return isNaN(a)||!isFinite(a)?Ob:a<=-Pb?T:a+1>=Pb?Qb:0>a?U(S(-a)):new Lb(a%Rb|0,a/Rb|0)}function V(a,b){return new Lb(a,b)}var Rb=4294967296,Pb=Rb*Rb/2,Ob=Nb(0),Sb=Nb(1),Tb=Nb(-1),Qb=V(-1,2147483647),T=V(0,-2147483648),Ub=Nb(16777216);l=Lb.prototype;
l.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(Vb(this))return"0";if(0>this.c){if(this.j(T)){var b=S(a),c=Wb(this,b),b=Xb(c.multiply(b),this);return c.toString(a)+b.f.toString(a)}return"-"+U(this).toString(a)}for(var c=S(Math.pow(a,6)),b=this,d="";;){var e=Wb(b,c),i=Xb(b,e.multiply(c)).f.toString(a),b=e;if(Vb(b))return i+d;for(;6>i.length;)i="0"+i;d=""+i+d}};function Yb(a){return 0<=a.f?a.f:Rb+a.f}function Vb(a){return 0==a.c&&0==a.f}
l.j=function(a){return this.c==a.c&&this.f==a.f};function Zb(a,b){if(a.j(b))return 0;var c=0>a.c,d=0>b.c;return c&&!d?-1:!c&&d?1:0>Xb(a,b).c?-1:1}function U(a){return a.j(T)?T:a.la().add(Sb)}l.add=function(a){var b=this.c>>>16,c=this.c&65535,d=this.f>>>16,e=a.c>>>16,i=a.c&65535,h=a.f>>>16,p;p=0+((this.f&65535)+(a.f&65535));a=0+(p>>>16);a+=d+h;d=0+(a>>>16);d+=c+i;c=0+(d>>>16);return V((a&65535)<<16|p&65535,(c+(b+e)&65535)<<16|d&65535)};function Xb(a,b){return a.add(U(b))}
l.multiply=function(a){if(Vb(this)||Vb(a))return Ob;if(this.j(T))return 1==(a.f&1)?T:Ob;if(a.j(T))return 1==(this.f&1)?T:Ob;if(0>this.c)return 0>a.c?U(this).multiply(U(a)):U(U(this).multiply(a));if(0>a.c)return U(this.multiply(U(a)));if(0>Zb(this,Ub)&&0>Zb(a,Ub))return S((this.c*Rb+Yb(this))*(a.c*Rb+Yb(a)));var b=this.c>>>16,c=this.c&65535,d=this.f>>>16,e=this.f&65535,i=a.c>>>16,h=a.c&65535,p=a.f>>>16,a=a.f&65535,u,x,ia,Kb;Kb=0+e*a;ia=0+(Kb>>>16);ia+=d*a;x=0+(ia>>>16);ia=(ia&65535)+e*p;x+=ia>>>16;
x+=c*a;u=0+(x>>>16);x=(x&65535)+d*p;u+=x>>>16;x=(x&65535)+e*h;u+=x>>>16;return V((ia&65535)<<16|Kb&65535,(u+(b*a+c*p+d*h+e*i)&65535)<<16|x&65535)};
function Wb(a,b){if(Vb(b))throw Error("division by zero");if(Vb(a))return Ob;if(a.j(T)){if(b.j(Sb)||b.j(Tb))return T;if(b.j(T))return Sb;var c=Wb($b(a,1),b).shiftLeft(1);if(c.j(Ob))return 0>b.c?Sb:Tb;var d=Xb(a,b.multiply(c));return c.add(Wb(d,b))}if(b.j(T))return Ob;if(0>a.c)return 0>b.c?Wb(U(a),U(b)):U(Wb(U(a),b));if(0>b.c)return U(Wb(a,U(b)));for(var e=Ob,d=a;0<=Zb(d,b);){for(var c=Math.max(1,Math.floor((d.c*Rb+Yb(d))/(b.c*Rb+Yb(b)))),i=Math.ceil(Math.log(c)/Math.LN2),i=48>=i?1:Math.pow(2,i-48),
h=S(c),p=h.multiply(b);0>p.c||0<Zb(p,d);)c-=i,h=S(c),p=h.multiply(b);Vb(h)&&(h=Sb);e=e.add(h);d=Xb(d,p)}return e}l.la=function(){return V(~this.f,~this.c)};l.ra=function(a){return V(this.f&a.f,this.c&a.c)};l.Ba=function(a){return V(this.f|a.f,this.c|a.c)};function ac(a,b){return V(a.f^b.f,a.c^b.c)}l.shiftLeft=function(a){a&=63;if(0==a)return this;var b=this.f;return 32>a?V(b<<a,this.c<<a|b>>>32-a):V(0,b<<a-32)};
function $b(a,b){b&=63;if(0==b)return a;var c=a.c;return 32>b?V(a.f>>>b|c<<32-b,c>>b):V(c>>b-32,0<=c?0:-1)};function bc(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}function cc(a){return new Uint8Array(Array.prototype.map.call(a,function(a){return a.charCodeAt(0)}))}function dc(){this.p=0}o(dc,Ib);function W(a){throw new va("Error deserializing incorrectly formated message, "+a);}
function Jb(a,b){for(var c=Fa(b.$()),d=[],e=0,i=0;i<c.length;i++){var h=c[i];if(F(b,h.o)){var p=0;do{var u=a.xa(h,b.get(h,p));d.push(u);e+=u.byteLength;p++}while(h.P&&p<Ia(b,h.o))}}c=new Uint8Array(e);for(i=e=0;i<d.length;i++)h=d[i],c.set(new Uint8Array(h),e),e+=h.byteLength;return c}
dc.prototype.xa=function(a,b){var c=a.l,d=ec[c],e=fc(S(a.o<<3|d)),i;switch(d){case X:var h=S(b);if(c==Ba||17==c)h=ac(h.shiftLeft(1),$b(h,63));i=fc(h);break;case gc:h=new ArrayBuffer(8);c=new DataView(h);switch(a.l){case 1:c.setFloat64(0,b,g);break;case za:i=S(b);c.setUint32(0,Yb(i),g);c.setUint32(4,i.c,g);break;case Aa:i=S(b);c.setUint32(0,Yb(i),g);c.setInt32(4,i.c,g);break;default:W("Unexpected field type")}i=new Uint8Array(h);break;case hc:switch(a.l){case 11:h=Jb(this,b);break;case 9:h=cc(unescape(encodeURIComponent(b)));
break;case 12:h=cc(b);break;default:W("Unexpected field type")}i=h.length;c=fc(S(i));i=new Uint8Array(c.length+i);i.set(c,0);i.set(h,c.length);break;case ic:W("Use of Groups deprecated and not supported");break;case jc:h=new ArrayBuffer(4);c=new DataView(h);switch(a.l){case 2:c.setFloat32(0,b,g);break;case 7:c.setUint32(0,b,g);break;case 15:c.setInt32(0,b,g);break;default:W("Unexpected field type")}i=new Uint8Array(h);break;default:W("Unexpected wire type")}h=new Uint8Array(e.length+i.length);h.set(new Uint8Array(e),
0);h.set(new Uint8Array(i),e.length);return h};function fc(a){function b(a){var d=S(128),d=Xb(a,Wb(a,d).multiply(d)).f,e=S(127);0<Zb(a,e)?(d+=128,a=b($b(a,7)),a.unshift(d)):a=[d];return a}a=b(a);return new Uint8Array(a)}
function kc(a,b,c){var d=b.$();for(a.p=0;a.p<c.length;){var e=lc(a,c),i=d.C[parseInt(e>>3,10)]||j,h=a,p=e%8,u=i,e=c,x=f;switch(p){case X:e=lc(h,e);if(u){h=f;switch(u.l){case xa:case ya:h=e.toString();break;case 5:case 13:case 14:h=e;break;case 17:e=S(e);h=ac($b(e,1),e.shiftLeft(63)).f;break;case Ba:e=S(e);h=ac($b(e,1),e.shiftLeft(63)).toString();break;case 8:h=0===h?k:g;break;default:W("Unexpected field type")}x=h}else x=j;break;case hc:p=e;e=lc(h,p);p=new Uint8Array(p.buffer,p.byteOffset+h.p,e);
h.p+=e;if(u){e=f;switch(u.l){case 9:e=decodeURIComponent(escape(bc(p)));break;case 12:e=bc(p);break;case 11:e=p;h=new dc;u=new u.Aa.K.Va;kc(h,u,e);e=u;break;default:W("Unexpected field type")}x=e}else x=j;break;case jc:e=new DataView(e.buffer,h.p,4);h.p+=4;if(u){h=f;switch(u.l){case 2:h=e.getFloat32(0,g);break;case 7:h=e.getUint32(0,g);break;case 15:h=e.getInt32(0,g);break;default:W("Unexpected field type")}x=h}else x=j;break;case gc:e=new DataView(e.buffer,h.p,8);h.p+=8;if(u){h=f;switch(u.l){case 1:h=
e.getFloat64(0,g);break;case za:h=(new Lb(e.getUint32(0,g),e.getUint32(4,g))).toString();break;case Aa:h=(new Lb(e.getUint32(0,g),e.getInt32(4,g))).toString();break;default:W("Unexpected field type")}x=h}else x=j;break;default:W("Unexpected wire type of "+p)}e=x;i!=j&&e!=j&&(i.P?b.add(i,e):b.set(i,e))}}function lc(a,b){var c=b[a.p++];if(127<c)var c=c-128,d=lc(a,b),c=c+(d<<7);return c}var X=0,gc=1,hc=2,ic=3,jc=5,ec=[-1,gc,jc,X,X,X,gc,jc,X,hc,ic,hc,hc,X,X,jc,gc,X,X];function Y(a,b){typeof a===f?a={}:"string"===typeof a&&(a={host:a});this.aa=a.host||this.Ga;this.da=a.port||this.pa;this.O=a.db||this.Fa;t(this.aa,"string");t(this.da,"number");t(this.O,"string");this.Q={};this.Ya=1;this.Y=b||j;ra=this}Y.prototype.Ga="localhost";Y.prototype.pa=12346;Y.prototype.Fa="test";Y.prototype.cb=function(a){this.constructor.call(this,{host:this.aa,port:this.da,db:this.O},a,this.Y)};Y.prototype.reconnect=Y.prototype.cb;function Z(a,b){if(a.Y)a.Y(b);else throw b;}
Y.prototype.eb=function(a){this.Y=a};Y.prototype.setErrorHandler=Y.prototype.eb;function mc(a,b,c,d,e){var i=b.k();i.na((a.Ya++).toString());a.Q[i.L()]={r:d||j,bb:b,ca:c,X:e||j,ma:[]};nc(a,i)}function nc(a,b){var c=Jb(new dc,b),d=c.byteLength,e=new Uint8Array(d+4);(new DataView(e.buffer)).setInt32(0,d,g);e.set(c,4);a.Ea(e.buffer)}Y.prototype.S=function(a,b){v(arguments,1);t(a,r);t(b,"function");mc(this,a,k,b)};Y.prototype.run=Y.prototype.S;Y.prototype.ea=function(a){this.S(a,function(a){console.log(a)})};
Y.prototype.runp=Y.prototype.ea;Y.prototype.ba=function(a,b,c){v(arguments,1);t(a,r);t(b,"function");mc(this,a,g,b,c)};Y.prototype.iter=Y.prototype.ba;
function oc(a,b){(new DataView(b.buffer)).getUint32(0,g)!==b.length-4&&Z(a,new P("RDB response corrupted, length inaccurate"));var c=new dc,d=new jb;try{kc(c,d,new Uint8Array(b.buffer,4))}catch(e){Z(a,new P("response deserialization failed"))}var i=D(d,1);if(c=a.Q[d.L()])switch(i){case 101:Z(a,new Gb(D(d,4)));break;case 103:var c=c.bb,i=D(d,4),d=D(d,5),h=[];d&&(h=Ha(d,1));d=i+"\n\t"+c.d()+"\n\t"+c.d(h);Z(a,new Fb(d));break;case 102:Z(a,new Hb(D(d,4)));break;case 0:delete a.Q[d.L()];c.r&&c.r();break;
case 3:delete a.Q[d.L()];d=Ha(d,3).map(JSON.parse);c.r&&(c.ca?d.forEach(c.r):c.r(c.ma.concat(d)));c.X&&c.ca&&c.X();break;case 1:delete a.Q[d.L()];d=JSON.parse(D(d,3,0));c.ca?(d.forEach&&c.r&&d.forEach(c.r),c.X&&c.X()):c.r&&c.r(d);break;case 2:i=new A;i.b(3);i.na(d.ya());nc(a,i);d=Ha(d,3).map(JSON.parse);c.r&&(c.ca?d.forEach(c.r):c.ma=c.ma.concat(d));break;default:Z(a,new P("unknown response status code"))}};function pc(a,b){this.mb=a;this.J=b||j}o(pc,r);pc.prototype.k=function(){var a=new N;a.b(this.mb);this.J&&a.U(this.J);var b=new A;b.b(5);B(b,5,a);return b};n("rethinkdb.dbCreate",function(a){v(arguments,1);t(a,"string");return new pc(1,a)});n("rethinkdb.dbDrop",function(a){v(arguments,1);t(a,"string");return new pc(2,a)});n("rethinkdb.dbList",function(){return new pc(3)});function $(a){this.F=a}n("rethinkdb.db",function(a){v(arguments,1);t(a,"string");return new $(a)});
$.prototype.list=function(){return new pc(6,this.F)};$.prototype.list=$.prototype.list;function qc(a,b,c,d,e){this.ua=a;this.J=b;this.oa=c;this.Da=d;this.ta=e}o(qc,r);qc.prototype.k=function(){var a=new I;a.U(this.J);B(a,2,this.oa);var b=new hb;this.ua&&B(b,1,this.ua);b.n(a);this.Da&&B(b,4,this.Da);this.ta&&B(b,5,this.ta);a=new N;a.b(4);B(a,3,b);b=new A;b.b(5);B(b,5,a);return b};
$.prototype.create=function(a){v(arguments,1);var b={};"string"===typeof a?b.tableName=a:b=a;t(b.tableName,"string");t(b.primaryKey,"string");t(b.dataCenter,"string");t(b.cacheSize,"string");return new qc(b.dataCenter,this.F,b.tableName,b.primaryKey,b.cacheSize)};$.prototype.create=$.prototype.create;function rc(a,b){v(arguments,1);this.J=a;this.oa=b}o(rc,r);rc.prototype.k=function(){var a=new I;a.U(this.J);B(a,2,this.oa);var b=new N;b.b(5);B(b,4,a);a=new A;a.b(5);B(a,5,b);return a};
$.prototype.Pa=function(a){v(arguments,1);t(a,"string");return new rc(this.F,a)};$.prototype.drop=$.prototype.Pa;$.prototype.ib=function(a){v(arguments,1);t(a,"string");return new z(a,this.F)};$.prototype.table=$.prototype.ib;function sc(a,b,c){t(b,"function");t(c,"function");Y.call(this,a,c);this.N="";var d=this,e="http://"+this.aa+":"+this.da+"/ajax/reql/",i=new XMLHttpRequest;i.responseType="arraybuffer";i.open("GET",e+"open-new-connection",g);i.onreadystatechange=function(){4===i.readyState&&(200===i.status?(d.N=e,d.ia=(new DataView(i.response)).getInt32(0,g),b&&b(d)):Z(d,new P("Unabled to establish HTTP connection")))};i.send()}o(sc,Y);n("rethinkdb.HttpConnection",sc);sc.prototype.pa=21300;
sc.prototype.Ea=function(a){this.N||Z(this,new P("Connection not open"));var b=new XMLHttpRequest;b.responseType="arraybuffer";b.open("POST",this.N+"?conn_id="+this.ia,g);var c=this;b.onreadystatechange=function(){4===b.readyState&&200===b.status&&oc(c,new Uint8Array(b.response))};b.send(a)};sc.prototype.close=function(){this.N||Z(this,new P("Connection not open"));var a=new XMLHttpRequest;a.open("POST",this.N+"close-connection?conn_id="+this.ia,g);a.send();this.N=this.ia=j};sc.prototype.close=sc.prototype.close;function tc(a,b,c){uc()||Z(this,new P("Cannot instantiate TcpConnection, TCP sockets are not available in this environment."));t(b,"function");t(c,"function");Y.call(this,a,c);this.M=j;this.Tc=0;this.B=j;var d=this;d.B=j;var e=require("net").connect(this.da,this.aa,function(){e.write("35ba61af","hex");e.on("data",ea(d.jb,d));e.on("end",function(){d.B=j;Z(d,new Fb("Server disconnected"))});d.B=e;b&&b(d)});e.on("error",function(){Z(d,new P("Unabled to establish TCP connection"))})}o(tc,Y);
n("rethinkdb.TcpConnection",tc);function uc(){return"undefined"!==typeof require&&require("net")}tc.isAvailable=uc;tc.prototype.Ea=function(a){this.B||Z(this,new P("Connection not open"));for(var b=new Buffer(a.byteLength),c=new Uint8Array(a),d=0;d<a.byteLength;d++)b[d]=c[d];this.B.write(b)};
tc.prototype.jb=function(a){for(var a=new Uint8Array(a),b=0,c=a.byteLength;0<c;){if(this.M===j){var d=(new DataView(a.buffer,b,c)).getUint32(0,g);this.M=new Uint8Array(d+4);this.R=0}var d=this.M.byteLength-this.R,e=c<d?c:d,i=new Uint8Array(a.buffer,b,e);this.M.set(i,this.R);this.R+=e;b+=e;c-=e;d-=e;0>=d&&(d=this.M,this.M=j,this.R=0,oc(this,d))}};
tc.prototype.close=function(){this.B||Z(this,new P("Connection not open"));var a=this;this.B.removeAllListeners("end");this.B.on("close",function(){a.B=j});this.B.end()};tc.prototype.close=tc.prototype.close;n("rethinkdb.connect",function(a,b,c){return uc()?new tc(a,b,c):new sc(a,b,c)});var ra=j;n("rethinkdb.getLastConnection",function(){return ra});"undefined"!==typeof exports&&("undefined"!==typeof module&&module.exports?exports=module.exports=aa.rethinkdb:exports.rethinkdb=aa.rethinkdb);
}).call(this);
